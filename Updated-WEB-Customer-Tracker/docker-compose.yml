version: '3.3'
services:
  app:
   container_name: app
   #image: web-customer-tracker:latest
   build: .
   ports:
     - "8090:8090"
   depends_on:
     db:
       condition: service_healthy
  db:
   container_name: db
   image: mysql:8.0.23
   environment:
     MYSQL_ROOT_PASSWORD:
     MYSQL_DATABASE: employee_directory
     MYSQL_USER: springstudent
     MYSQL_PASSWORD: springstudent
   volumes:
     - ./db/mysql-datadir:/var/lib/mysql
     - ./dbdump:/docker-entrypoint-initdb.d
   ports:
     - "3306:3306"
   healthcheck:
     test: mysqladmin ping -h 127.0.0.1 -u $$MYSQL_USER --password=$$MYSQL_PASSWORD
